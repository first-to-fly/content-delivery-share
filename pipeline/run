#!/usr/bin/env bash

export SHOULD_LOG_TIME=true

# shellcheck disable=SC1090
source "${BASH_SOURCE[0]%/*}/lib/core.sh"

# shellcheck disable=SC1090
source "${BASH_SOURCE[0]%/*}/lib/node.sh"

function main() {

  if [[ ! -d "./node_modules" ]]; then
    "${BASH_SOURCE[0]%/*}/install"
  fi

  if [[ ! -d "./build" ]]; then
    "${BASH_SOURCE[0]%/*}/build"
  fi

  echo -e "${OK_COLOR}==> Running app..."

  NPM="$(command -v npm)"

  (
    set -x
    "${NPM}" start
  )

}

main "$@" ||
  catch "$?" &&
  finally
